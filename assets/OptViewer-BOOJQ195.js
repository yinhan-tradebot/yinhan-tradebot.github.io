import{b as p,e as g,f as y,i as c,aq as M,ar as A,aU as I,h as K,r as i,E as N,o as U,l as h,n as d,F,v as P,u as q,aV as z,aW as b,aX as J,A as L}from"./index-BmNJeyAp.js";import{_ as T,b as W,a as X}from"./MyPlot-BF1e1AVO.js";import{P as G}from"./Plotter-jKmwtM96.js";import{_ as H}from"./MarkDown-oila5sVd.js";const Q={__name:"FileInput",emits:["change"],setup(r,{emit:t}){const l=t;function u(e){l("change",Array.from(e.target.files)),e.target.value=null}return(e,s)=>(p(),g("label",null,[y("input",{hidden:"",type:"file",multiple:"",onChange:u},null,32),c(T,{class:"col",i:"upload"})]))}},R=["placeholder","value"],Y={__name:"EnterInput",props:M(["ph"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const t=A(r,"modelValue");function l(e){const s=e.target.value;s||(t.value=s)}function u(e){t.value=e.target.value}return(e,s)=>(p(),g("input",{class:"input mv5",placeholder:r.ph,value:t.value,onInput:l,onKeydown:I(u,["enter"])},null,40,R))}},j={__name:"DebugData",props:["data"],setup(r){function t(l){return`
\`\`\`json
${JSON.stringify(l,null,2)}
\`\`\`
  `}return(l,u)=>(p(),K(H,{text:t(r.data)},null,8,["text"]))}},Z={class:"f1 row start m10"},ee={class:"col g5",style:{width:"300px"}},te={class:"row"},ae={class:"row wrap gh20"},oe=["onClick"],ce={__name:"OptViewer",setup(r){const t={upload:"上传优化结果文件(json):",minSim:"最小相似度:",picked:"选中结果1:",picked2:"选中结果2:",modes:["hover激活","click激活"],xAxis:"y 轴:"},l=i(),u={},e=i([{ma_period:45,offset_enter:.05,offset_exit:.007,n_slot:3,take_profit:.03,stop_loss:-.56,timeout:297,ratio_used:.82}]),s=i(),m=i(.95),k=i(1),O=Object.keys(e.value[0]),_=i();N([e,m,_],V),U(async()=>{});async function E(v){for(let o of v)u[o.name]=await z(o);V()}function V(){const v=e.value?Object.values(e.value[0]):null,o=new G;Object.entries(u).forEach(([a,$])=>{a=a.replace(".json","").replace("recorder_","");const w="n_slot",C=b.groupBy($.xy,x=>x[0][w]);Object.entries(C).forEach(([x,S])=>{const B=S.map(n=>{let f;if(v&&m.value){const D=Object.values(n[0]);J(v,D)>m.value&&(f="red")}return b.isEqual(e.value[0],n[0])&&(f="black"),{x:n[1][0],y:_.value?n[0][_.value]:n[1][1],click:()=>{k.value==0?s.value=n:e.value=n},hover:()=>{k.value==0?e.value=n:s.value=n},color:f,opacity:f?.7:.3,size:f?12:6}});o.plot(B,".",`${a} ${w}=${x}`)})}),o.option.tooltip=!1,l.value=o.option}return(v,o)=>(p(),g("div",Z,[y("div",ee,[h(d(t.upload)+" ",1),c(Q,{onChange:E}),h(" "+d(t.minSim)+" ",1),y("div",null,[c(Y,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=a=>m.value=a)},null,8,["modelValue"])]),y("div",te,[c(W,{items:t.modes,modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=a=>k.value=a)},null,8,["items","modelValue"])]),h(" "+d(t.xAxis)+" ",1),y("div",ae,[(p(!0),g(F,null,P(q(O),a=>(p(),g("div",{class:L({link:_.value==a}),key:a,onClick:$=>_.value=a},d(a),11,oe))),128))]),h(" "+d(t.picked)+" ",1),c(j,{data:e.value},null,8,["data"]),h(" "+d(t.picked2)+" ",1),c(j,{data:s.value},null,8,["data"])]),c(X,{option:l.value},null,8,["option"])]))}};export{ce as default};
